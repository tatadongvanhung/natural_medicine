@{
	ViewBag.Title = "Category";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

@using natural_medicine.Models
@model List<product>

@{
	category category = ViewBag.category;

}

<div class="modal fade" id="myModal" role="dialog">
	<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Natural Medicine Shop</h4>
			</div>
			<div class="modal-body">
				<p>Thêm sản phẩm thành công!</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
			</div>
		</div>
	</div>
</div>

<ul class="breadcrumb">
	<li><a href="/home/index">Trang chủ</a> <span class="divider">/</span></li>
	<li class="active">@category.name</li>
</ul>

@{ var group = Model.GroupBy(r => Model.IndexOf(r) / 4).ToList();

	foreach (var parentItem in group)
	{
		<ul class="thumbnails">

			@foreach (product it in parentItem)
			{

				<li class="span3">
					<div class="thumbnail">
						<a href="product_details.html" class="overlay"></a>
						<a class="zoomTool" href="/Home/product/@it.id" title=""><span class="icon-search"></span> XEM</a>
						<a href="/Home/product/@it.id"><img src="~/Content/assets/img/@it.image_url" alt=""></a>
						<div class="caption cntr">
							<p>@it.name</p>
							<p><strong> @it.price đ</strong></p>
							@*<h4><a class="shopBtn" href="/Cart/AddItem/@it.id" title="THÊM VÀO GIỎ"> THÊM VÀO GIỎ </a></h4>*@
							<button class="shopBtn add-cart" title="THÊM VÀO GIỎ" name="@it.id" data-toggle="modal" data-target="#myModal">THÊM VÀO GIỎ</button>
							<br class="clr">
						</div>
					</div>
				</li>
			}

		</ul>
	}
}

<script>
	$(document).ready(function () {
		$(".add-cart").click(function () {
			var name = $(this).attr("name");
			var serviceURL = '/Cart/AddItem/' + name;
			$.ajax({
				url: serviceURL,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: successFunc,
				error: errorFunc
			});
			function successFunc(data, status) {
				$("#myModal").show();
			}
			function errorFunc() {
				alert("Thêm sản phẩm thất bại!")
			}
		});
	});
</script>